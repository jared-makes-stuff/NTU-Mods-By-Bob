# ============================================================================
# NTU Mods Backend Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control - it contains sensitive secrets
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
# PostgreSQL connection string
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public
DATABASE_URL="postgresql://postgres:password@localhost:5432/ntu_mods_db?schema=public"

# ----------------------------------------------------------------------------
# JWT (JSON Web Token) CONFIGURATION
# ----------------------------------------------------------------------------
# Secret key for signing JWT tokens - MUST be a strong random string in production
# Generate with: openssl rand -base64 64
JWT_SECRET="your-super-secret-jwt-key-change-this-in-production"

# Token expiration times
JWT_EXPIRES_IN="7d"              # Access token lifetime (e.g., "7d", "24h", "60m")
JWT_REFRESH_EXPIRES_IN="30d"     # Refresh token lifetime

# ----------------------------------------------------------------------------
# ADMIN CONFIGURATION
# ----------------------------------------------------------------------------
# Comma-separated list of email addresses that should be granted the "admin" role
# Example: "admin@example.com,superadmin@example.com"
ADMIN_EMAILS="admin@example.com"

# ----------------------------------------------------------------------------
# OAUTH CONFIGURATION
# ----------------------------------------------------------------------------
# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
GOOGLE_REDIRECT_URI="http://localhost:3000/api/auth/google/callback"

# GitHub OAuth
GITHUB_CLIENT_ID="your-github-client-id"
GITHUB_CLIENT_SECRET="your-github-client-secret"
GITHUB_REDIRECT_URI="http://localhost:3000/api/auth/github/callback"

# ----------------------------------------------------------------------------
# SERVER CONFIGURATION
# ----------------------------------------------------------------------------
PORT=3000                        # Port the server listens on
NODE_ENV="development"           # Environment: "development" | "production" | "test"

# ----------------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing)
# ----------------------------------------------------------------------------
# Comma-separated list of allowed origins (frontend URLs)
ALLOWED_ORIGINS="http://localhost:3001,http://localhost:3000"

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------
# Time window for rate limiting (e.g., "15m", "1h")
RATE_LIMIT_WINDOW="15m"

# Maximum requests per window for public endpoints
RATE_LIMIT_MAX="100"

# Maximum requests per window for authenticated endpoints
RATE_LIMIT_AUTH_MAX="1000"

# ----------------------------------------------------------------------------
# EMAIL CONFIGURATION (for password reset, notifications)
# ----------------------------------------------------------------------------
# SMTP server configuration
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_SECURE=false                # true for 465, false for other ports
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"    # Use app-specific password for Gmail
SMTP_FROM="NTU Mods <noreply@ntumods.dev>"

# ----------------------------------------------------------------------------
# EXTERNAL API SOURCE (University API)
# ----------------------------------------------------------------------------
# URL for the external university module data API
EXTERNAL_API_URL="https://api.university.edu/modules"
EXTERNAL_API_KEY="your-api-key-here"

# ----------------------------------------------------------------------------
# REDIS CACHE CONFIGURATION
# ----------------------------------------------------------------------------
# Enable Redis caching for read-heavy catalogue endpoints
REDIS_ENABLED=false

# Preferred: full connection string (overrides host/port)
# REDIS_URL="redis://user:password@localhost:6379/0"

# Host/port configuration (used when REDIS_URL is not set)
REDIS_HOST="127.0.0.1"
REDIS_PORT=6379
REDIS_USERNAME=""
REDIS_PASSWORD=""
REDIS_DB=0
REDIS_TLS=false

# Key prefix for all cache entries
REDIS_KEY_PREFIX="ntumods:"

# Default cache TTL for catalogue responses (seconds)
CACHE_DEFAULT_TTL_SECONDS=900

# ----------------------------------------------------------------------------
# VACANCY ALERTS & TELEGRAM BOT
# ----------------------------------------------------------------------------
# Enable Telegram bot for vacancy alerts
TELEGRAM_BOT_ENABLED=false

# Telegram bot token from BotFather (required when enabled)
TELEGRAM_BOT_TOKEN="your-telegram-bot-token"

# Polling interval for Telegram updates (seconds)
TELEGRAM_BOT_POLL_INTERVAL_SECONDS=2

# Vacancy alert check interval (seconds)
VACANCY_ALERTS_CHECK_INTERVAL_SECONDS=300

# TTL for cached vacancy results stored in the Index table (seconds)
VACANCY_CACHE_TTL_SECONDS=900

# Vacancy service availability window (24h, Singapore time)
VACANCY_SERVICE_START_HOUR=9
VACANCY_SERVICE_END_HOUR=22

# ----------------------------------------------------------------------------
# DATA SYNC CONFIGURATION
# ----------------------------------------------------------------------------
# Cron schedule for automatic data synchronization
# Format: "minute hour day month day-of-week"
# Default: "0 2 * * *" (runs at 2:00 AM daily)
SYNC_CRON_SCHEDULE="0 2 * * *"

# Enable/disable automatic data sync
SYNC_ENABLED=true

# Run sync on startup
SYNC_ON_STARTUP=true

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
# Logging level: "error" | "warn" | "info" | "http" | "debug"
LOG_LEVEL="info"
